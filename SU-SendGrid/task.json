{
  "$schema": "https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json",
  "id": "1d03e40f-ba2b-48ca-b560-33ddc53caa01",
  "name": "su-sendgrid",
  "friendlyName": "SendGrid E-Mail",
  "description": "SendGrid Azure DevOps Extension",
  "author": "Bruce Foust",
  "helpMarkDown": "",
  "category": "Utility",
  "visibility": [
    "Build",
    "Release"
  ],
  "version": {
    "Major": 0,
    "Minor": 2,
    "Patch": 27
  },
  "instanceNameFormat": "SendGrid E-Mail",
  "groups": [
    {
      "name": "ConfigureSendGrid",
      "displayName": "Configure SendGrid",
      "isExpanded": true
    },
    {
      "name": "ConfigureEmail",
      "displayName": "Configure E-mail",
      "isExpanded": true
    },
    {
      "name": "ConfigureCopyEmail",
      "displayName": "Configure CC or BCC addresses",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "SendGridAPIKey",
      "type": "string",
      "label": "SendGgrid API Key",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Generate your API Key from the SendGrid Portal",
      "groupName": "ConfigureSendGrid"
    },
    {
      "name": "senderEmailAddress",
      "type": "string",
      "label": "Sender Email Address",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Email address of the sender. The value can either be only the Email Address (Eg. alex.johnson@example.com)",
      "groupName": "ConfigureEmail"
    },
    {
      "name": "recipientEmailAddress",
      "type": "string",
      "label": "Recipient Email Address(s)",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Email address(s) of the recipient(s). Use a comma (,) separated list if you have multiple email addresses. (Eg. alex.johnson@example.com, jamie.lee@example.com) or the Name and the Email Address (Eg. Alex Johnson <alex.johnson@example.com>, Jamie Lee <jamie.lee@example.com>)",
      "groupName": "ConfigureEmail"
    },
    {
      "name": "ccEmailAddress",
      "type": "string",
      "label": "CC Email Address",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Email address(s) of the cc recipient(s). Use a comma (,) separated list if you have multiple email addresses. (Eg. alex.johnson@example.com, jamie.lee@example.com) or the Name and the Email Address (Eg. Alex Johnson <alex.johnson@example.com>, Jamie Lee <jamie.lee@example.com>)",
      "groupName": "ConfigureCopyEmail"
    },
    {
      "name": "bccEmailAddress",
      "type": "string",
      "label": "BCC Email Address",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Email address(s) of the bcc recipient(s). Use a comma (,) separated list if you have multiple email addresses. (Eg. alex.johnson@example.com, jamie.lee@example.com) or the Name and the Email Address (Eg. Alex Johnson <alex.johnson@example.com>, Jamie Lee <jamie.lee@example.com>)",
      "groupName": "ConfigureCopyEmail"
    },
    {
      "name": "emailSubject",
      "type": "string",
      "label": "Subject",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Subject of the email.",
      "groupName": "ConfigureEmail"
    },
    {
      "name": "emailBody",
      "type": "pickList",
      "label": "Email Body",
      "defaultValue": "Text",
      "required": true,
      "helpMarkDown": "Body of the email.",
      "options": {
        "text": "Text",
        "file": "File"
      },
      "groupName": "ConfigureEmail"
    },
    {
      "name": "emailBodyText",
      "type": "string",
      "label": "Email Body text",
      "defaultValue": "SendGrid Email from Azure DevOps Pipeline",
      "required": false,
      "helpMarkDown": "Email body text. HTML tags are allowed. This input is required if 'Text' is selected for Email Body.",
      "visibleRule": "emailBody = Text",
      "groupName": "ConfigureEmail"
    },
    {
      "name": "emailBodyFilePath",
      "type": "string",
      "label": "Email Body File Path",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Path to the file containing the email body. This input is required if 'File' is selected for Email Body.",
      "visibleRule": "emailBody = File",
      "groupName": "ConfigureEmail"
    },
    {
      "name": "sendAsHTML",
      "type": "boolean",
      "label": "Send as HTML",
      "defaultValue": true,
      "required": false,
      "helpMarkDown": "Check to send the email as HTML."
    }
  ],
  "execution": {
    "Node20_1": {
      "target": "index.js"
    }
  },
  "restrictions": {
    "commands": {
      "mode": "restricted"
    },
    "settableVariables": {
      "allowed": [
        "variable1",
        "test*"
      ]
    }
  }
}